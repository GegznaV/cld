% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cld.R
\name{make_cld}
\alias{make_cld}
\alias{make_cld.pairwise.htest}
\alias{make_cld.posthoc_anova}
\alias{make_cld.PMCMR}
\alias{make_cld.PostHocTest}
\alias{make_cld.DunnTest}
\alias{make_cld.formula}
\alias{make_cld.matrix}
\alias{make_cld.data.frame}
\alias{make_cld.pairwise_pval_df}
\title{Make a compact letter display (CLD) for pair-wise comparisons}
\usage{
make_cld(obj, ..., alpha = 0.05)

\method{make_cld}{pairwise.htest}(obj, ..., alpha = 0.05)

\method{make_cld}{posthoc_anova}(obj, ..., alpha = 1 - obj$input$conf_level)

\method{make_cld}{PMCMR}(obj, ..., alpha = 0.05)

\method{make_cld}{PostHocTest}(obj, ..., alpha = 0.05)

\method{make_cld}{DunnTest}(obj, ..., alpha = 0.05)

\method{make_cld}{formula}(obj, ..., data = NULL, alpha = 0.05)

\method{make_cld}{matrix}(obj, ..., alpha = 0.05)

\method{make_cld}{data.frame}(
  obj,
  ...,
  alpha = 0.05,
  gr1_col = "group1",
  gr2_col = "group2",
  p_val_col = "p.adj",
  remove.space = FALSE
)

\method{make_cld}{pairwise_pval_df}(obj, ..., alpha = 0.05)
}
\arguments{
\item{obj}{Object with pair-wise comparisons (e.g., post-hoc test results).
Currently supported object classes:
\itemize{
\item \code{PMCMR} - from packages \strong{PMCMR} and \strong{PMCMRplus}
\item \code{pairwise.htest} - from base R (e.g., \code{pairwise.t.test}, \code{pairwise.wilcox.test})
\item \code{posthoc_anova} - from package \strong{rstatix} (e.g., \code{games_howell_test}, \code{tukey_hsd})
\item \code{PostHocTest} - from package \strong{DescTools} (e.g., \code{ConoverTest}, \code{DunnettTest})
\item \code{DunnTest} - from package \strong{DescTools}
\item \code{matrix} - symmetric matrices of p-values
\item \code{data.frame} - with comparison results (requires \code{gr1_col}, \code{gr2_col}, \code{p_val_col} specification)
\item \code{formula} - interface for data frames
\item \code{pairwise_pval_df} - output from \code{\link[=pval_matrix_to_df]{pval_matrix_to_df()}}
}}

\item{...}{Further arguments passed to internal methods. These may include:
\itemize{
\item \code{reversed} - Logical. If \code{TRUE}, reverses the letter ordering (default: \code{FALSE})
\item \code{swap_compared_names} - Logical. If \code{TRUE}, swaps group order in comparisons (default: \code{FALSE})
\item \code{print.comp} - Logical. If \code{TRUE}, prints comparison names (default: \code{FALSE})
Additional cleaning options (default: \code{TRUE} for most methods):
\item \code{remove.space} - Removes spaces from comparison strings
\item \code{remove.equal} - Removes equal signs from comparison strings
\item \code{swap.colon} - Replaces colons with hyphens
\item \code{swap.vs} - Replaces "vs" with hyphens (default: \code{FALSE})
}}

\item{alpha}{Numeric value between 0 and 1. The significance level (alpha) for determining
which comparisons are significantly different. Comparisons with p-values below this
threshold are considered significant. Default is 0.05.
Note: For \code{posthoc_anova} objects, the default is calculated as \code{1 - conf_level}.}

\item{data}{A data frame with p-values and names of comparisons. This argument
is required when \code{obj} is a formula. The data frame should contain at least
two columns: one for p-values and one for comparison labels. See examples for details.}

\item{gr1_col}{Character string. Name of the column in the data frame containing
the first group names in each pairwise comparison. Default is \code{"group1"}.
Only used for the data.frame method. The function will construct comparisons
in the format \code{gr2-gr1}.}

\item{gr2_col}{Character string. Name of the column in the data frame containing
the second group names in each pairwise comparison. Default is \code{"group2"}.
Only used for the data.frame method.}

\item{p_val_col}{Character string. Name of the column in the data frame containing
the p-values for each comparison. Default is \code{"p.adj"} (adjusted p-values).
Only used for the data.frame method. Can also be \code{"p.value"} or any other
column name containing numeric p-values.}

\item{remove.space}{Logical. If \code{TRUE}, removes spaces from comparison strings.
Default is \code{FALSE} for the data.frame method to preserve original formatting.
Set to \code{TRUE} if your group names contain spaces and you want compact comparisons.}

\item{formula}{An R model \code{\link[stats:formula]{stats::formula()}} where the left-hand side
term indicates the variable with p-values and the right-hand side term defines
the variable with comparisons, e.g., \code{p.adjust ~ Comparison}. This provides
a flexible way to specify which columns in \code{data} contain the relevant information.
Usually used in combination with \code{data}.}
}
\value{
A data frame of class \code{c("cld_object", "data.frame")} with three columns:
\itemize{
\item \code{group} - Character. The names of the groups being compared
\item \code{cld} - Character. The compact letter display for each group. Groups sharing
at least one letter are not significantly different from each other
\item \code{spaced_cld} - Character. A monospaced version of the CLD where spaces are
replaced with underscores, useful for maintaining alignment in output
}

The rows are ordered according to the group names. Groups with the same letter(s)
do not differ significantly at the specified alpha level.
}
\description{
Creates a compact letter display for results of pair-wise comparisons
(e.g., ANOVA post-hoc tests, Kruskal-Wallis post-hoc tests, and others).
Groups that share the same letter are not significantly different from each other.
This provides a visual summary of which groups differ significantly, commonly used
in agricultural, biological, and statistical reporting.
}
\details{
\subsection{Method for rstatix objects (\code{posthoc_anova})}{

The \code{posthoc_anova} method supports objects from the \strong{rstatix} package,
specifically results from \code{games_howell_test()} and \code{tukey_hsd()}.
The significance level is automatically derived from the confidence level
used in the test (alpha = 1 - conf_level), but can be overridden.
}
}
\examples{
# Example 1: Using pairwise.htest (Wilcoxon test)
obj1 <- stats::pairwise.wilcox.test(chickwts$weight, chickwts$feed, exact = FALSE)
cld::make_cld(obj1)

# Example 2: Using pairwise.htest (t-test)
obj2 <- with(OrchardSprays, stats::pairwise.t.test(decrease, treatment))
cld::make_cld(obj2)

# Example 3: Using pairwise.htest (proportion test)
\donttest{
smokers <- c(83, 90, 129, 70)
patients <- c(86, 93, 136, 82)
obj3 <- stats::pairwise.prop.test(smokers, patients)
cld::make_cld(obj3)
}

# Example 4: Using PMCMR objects
\donttest{
obj4 <- PMCMRplus::kwAllPairsConoverTest(count ~ spray, data = InsectSprays)
cld::make_cld(obj4)
}

# Example 5: Using DescTools objects
\donttest{
obj5 <- DescTools::ConoverTest(weight ~ group, data = PlantGrowth)
cld::make_cld(obj5)
}

# Example 6: Using rstatix objects
\donttest{
obj6 <- rstatix::games_howell_test(PlantGrowth, weight ~ group)
cld::make_cld(obj6)
}

# Example 7: Using formula interface
my_dataframe <- utils::read.table(
  text = c(
    'Comparison     p.value p.adjust
    "EE - GB = 0"        1 1.000000
    "EE - CY = 0" 0.001093 0.003279
    "GB - CY = 0" 0.005477 0.008216'
  ),
  header = TRUE
)
cld::make_cld(p.adjust ~ Comparison, data = my_dataframe)

# Example 8: Using a symmetric matrix of p-values
# Create matrix
m <- c(
  1.00, 0.22, 0.05, 0.00,
  0.22, 1.00, 0.17, 0.01,
  0.05, 0.17, 1.00, 0.22,
  0.00, 0.01, 0.22, 1.00
)
obj8 <- matrix(m, nrow = 4)
rownames(obj8) <- colnames(obj8) <- c("P", "O", "I", "U")
obj8

# Make CLD
cld::make_cld(obj8)

# Example 9: Using data.frame method with custom column names
my_data <- data.frame(
  group1 = c("A", "A", "B"),
  group2 = c("B", "C", "C"),
  p.adj = c(0.001, 0.045, 0.892)
)
cld::make_cld(my_data, gr1_col = "group1", gr2_col = "group2", p_val_col = "p.adj")

}
\references{
Piepho HP (2004). An algorithm for a letter-based representation of
all-pairwise comparisons. Journal of Computational and Graphical Statistics,
13(2), 456-466. \doi{10.1198/1061860043515}, available at
https://www.tandfonline.com/doi/abs/10.1198/1061860043515
}
\seealso{
\itemize{
\item \code{\link[=pval_matrix_to_df]{pval_matrix_to_df()}} for converting p-value matrices to data frames
\item \code{\link[multcompView:multcompLetters]{multcompView::multcompLetters()}} for the underlying letter generation algorithm
}
}
